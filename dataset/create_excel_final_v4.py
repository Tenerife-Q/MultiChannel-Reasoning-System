import pandas as pd
import os

"""
================================================================================
YuanJing AI æœ€ç»ˆç‰ˆæ•°æ®æ ‡å‡† (The Final Schema)
æ–‡ä»¶å: create_excel_final_v4.py
ç”¨é€”: ç”Ÿæˆç©ºè¡¨å¤´ï¼Œç”¨äºå›¢é˜Ÿäººå·¥å½•å…¥æ•°æ®

ã€ç­”è¾©é€»è¾‘è®¾è®¡ã€‘
ä¸ºäº†å±•ç¤º "å±‚å±‚é€’è¿›" çš„é˜²å¾¡èƒ½åŠ›ï¼Œæˆ‘ä»¬éœ€è¦ä¸¥æ ¼æ§åˆ¶å˜é‡ï¼š
1. Type 2 (Tamper): å›¾å‡ï¼Œæ–‡çœŸ -> åªæœ‰ Ch1 èƒ½å‘ç°
2. Type 3 (Mismatch): å›¾çœŸï¼Œæ–‡å‡(ç¦»è°±) -> åªæœ‰ Ch2 èƒ½å‘ç°
3. Type 4 (Logic): å›¾çœŸï¼Œæ–‡å‡(éšè”½) -> åªæœ‰ Ch3 èƒ½å‘ç°
================================================================================
"""

# ============================================================================
# å­—æ®µå®šä¹‰ï¼šæ˜ç¡®åŒºåˆ† "äººå·¥è¾“å…¥" å’Œ "ç³»ç»Ÿè®¡ç®—"
# ============================================================================
columns_info = {
    # --- A. åŸºç¡€ä¿¡æ¯ (Manual Input: å¿…é¡»æ‰‹å¡«) ---
    "ID": "æ ·æœ¬ç¼–å·ï¼Œå¦‚ 001",
    "Sample_Type": "æ ·æœ¬ç±»å‹ï¼Œå¿…å¡«: [Real, Tamper_PS, Tamper_AIGC, Mismatch, Logic_Trap]",
    "Image_Path": "å›¾ç‰‡è·¯å¾„ï¼Œå¦‚ data/images/xxx.jpg",
    "Text_Content": "æ–°é—»æ–‡æœ¬å†…å®¹",

    # --- B. éªŒè¯çœŸå€¼ (Ground Truth: å¿…é¡»æ‰‹å¡«ï¼Œç”¨äºç®—æˆåŠŸç‡) ---
    "GT_Final_Label": "æœ€ç»ˆçœŸå‡: 1=Fake, 0=Real",
    "GT_Ch1_Tamper": "Ch1æ ‡å‡†ç­”æ¡ˆ: 1=å›¾è¢«ç¯¡æ”¹, 0=å›¾æ˜¯åŸå›¾",
    "GT_Ch2_Mismatch": "Ch2æ ‡å‡†ç­”æ¡ˆ: 1=å›¾æ–‡ä¸ç¬¦, 0=ä¸€è‡´",
    "GT_Ch3_Logic": "Ch3æ ‡å‡†ç­”æ¡ˆ: 1=é€»è¾‘å†²çª, 0=è‡ªæ´½",
    
    # --- C. é€»è¾‘æ¨ç†å…ƒæ•°æ® (Meta Data: å¿…é¡»æ‰‹å¡«ï¼ŒCh3 Mock çš„ä¾æ®) ---
    # æ³¨æ„ï¼šè¿™äº›å­—æ®µå¿…é¡»å¡« "å›¾ç‰‡é‡Œå®¢è§‚å­˜åœ¨çš„çœŸå®å±æ€§"ï¼Œè€Œä¸æ˜¯æ–‡æœ¬é‡Œè¯´çš„å±æ€§ï¼
    "Meta_Time": "æ—¶é—´: Day / Night / Unknown",
    "Meta_Weather": "å¤©æ°”: Sunny / Rain / Snow / Cloudy / Unknown",
    "Meta_Location": "åœ°ç‚¹: Paris / Street / Indoor / Unknown",
    "Meta_Fact": "çŠ¶æ€: Empty / Crowded / Unknown",
    "Meta_Object": "ç‰©ä½“: Person / Car / Fire / Unknown",

    # --- D. å¤‡æ³¨ (å¯é€‰) ---
    "Source_Note": "å¤‡æ³¨é€ å‡æ‰‹æ®µï¼Œå¦‚ 'ä½¿ç”¨Magic Eraseræ“¦é™¤'"
}

columns_order = list(columns_info.keys())

# ============================================================================
# æ„é€  "æ•™ç§‘ä¹¦çº§" çš„ç¤ºä¾‹æ•°æ® (æŒ‡å¯¼å›¢é˜Ÿæ€ä¹ˆå¡«)
# ============================================================================
data = [
    # ------------------------------------------------------------------------
    # Level 0: çœŸå®æ ·æœ¬ (Real) - ç”¨äºè®¡ç®—è¯¯æŠ¥ç‡
    # ------------------------------------------------------------------------
    {
        "ID": "001",
        "Sample_Type": "Real",
        "Image_Path": "data/images/real_001.jpg",
        "Text_Content": "é™†å®¶å˜´çš„æ‘©å¤©å¤§æ¥¼åœ¨é˜³å…‰ä¸‹ç† ç† ç”Ÿè¾‰ã€‚",
        # GTå…¨æ˜¯0ï¼Œè¡¨ç¤ºè¿™å°±æ˜¯ä¸ªå¥½äºº
        "GT_Final_Label": 0,
        "GT_Ch1_Tamper": 0, "GT_Ch2_Mismatch": 0, "GT_Ch3_Logic": 0,
        # Meta å¡«å†™çœŸå®å±æ€§
        "Meta_Time": "Day", "Meta_Weather": "Sunny", "Meta_Location": "Shanghai",
        "Meta_Fact": "Skyscrapers", "Meta_Object": "Building",
        "Source_Note": "ã€çœŸã€‘åº•åº“æ ·æœ¬"
    },

    # ------------------------------------------------------------------------
    # Level 1: ç‰©ç†å±‚æ”»å‡» (Tamper) - è¿™é‡Œçš„å›¾å¿…é¡»æ˜¯ã€å‡ã€‘çš„ï¼
    # ------------------------------------------------------------------------
    {
        "ID": "011",
        "Sample_Type": "Tamper_AIGC",
        "Image_Path": "data/images/aigc_eraser_001.jpg",
        "Text_Content": "è¡—é“éå¸¸å¹²å‡€ï¼Œæ²¡æœ‰åƒåœ¾ã€‚", # æ–‡æœ¬å¾ˆè¯šå®ï¼Œä¸ºäº†é€šè¿‡ Ch2/3
        # åªæœ‰ Ch1 æ˜¯ 1
        "GT_Final_Label": 1,
        "GT_Ch1_Tamper": 1, # <--- åªæœ‰è¿™é‡Œæ˜¯ 1
        "GT_Ch2_Mismatch": 0, "GT_Ch3_Logic": 0,
        # Meta å¡«ç¯¡æ”¹åå›¾ç‰‡çœ‹èµ·æ¥çš„æ ·å­
        "Meta_Time": "Day", "Meta_Weather": "Cloudy", "Meta_Location": "Street",
        "Meta_Fact": "Clean", "Meta_Object": "Road",
        "Source_Note": "ã€å‡ã€‘AIGCæ¶ˆé™¤ï¼Œåªæœ‰Ch1èƒ½æµ‹å‡ºæ¥"
    },

    # ------------------------------------------------------------------------
    # Level 2: è¯­ä¹‰å±‚æ”»å‡» (Mismatch) - è¿™é‡Œçš„å›¾å¿…é¡»æ˜¯ã€çœŸã€‘çš„ï¼
    # ------------------------------------------------------------------------
    {
        "ID": "031",
        "Sample_Type": "Mismatch",
        "Image_Path": "data/images/real_fire.jpg",
        "Text_Content": "å•†åœºä¸¾åŠç››å¤§ä¿ƒé”€æ´»åŠ¨ã€‚", # çç¼–çš„
        # åªæœ‰ Ch2 æ˜¯ 1
        "GT_Final_Label": 1,
        "GT_Ch1_Tamper": 0, # å›¾æ˜¯çœŸçš„ï¼
        "GT_Ch2_Mismatch": 1, # <--- åªæœ‰è¿™é‡Œæ˜¯ 1
        "GT_Ch3_Logic": 0,
        "Meta_Time": "Day", "Meta_Weather": "Sunny", "Meta_Location": "Forest",
        "Meta_Fact": "Fire", "Meta_Object": "Tree",
        "Source_Note": "ã€å‡ã€‘ç§»èŠ±æ¥æœ¨ï¼ŒCh2 æ‹¦æˆª"
    },

    # ------------------------------------------------------------------------
    # Level 3: è®¤çŸ¥å±‚æ”»å‡» (Logic) - è¿™é‡Œçš„å›¾å¿…é¡»æ˜¯ã€çœŸã€‘çš„ï¼
    # ------------------------------------------------------------------------
    {
        "ID": "041",
        "Sample_Type": "Logic_Trap",
        "Image_Path": "data/images/real_noon.jpg", # çœŸå›¾(æ­£åˆ)
        "Text_Content": "æ·±å¤œçš„è¡—é“æ ¼å¤–å®é™ï¼Œæœˆå…‰å¦‚æ°´ã€‚", # æ–‡æœ¬æ’’è°(æ·±å¤œ)
        # åªæœ‰ Ch3 æ˜¯ 1
        "GT_Final_Label": 1,
        "GT_Ch1_Tamper": 0, # å›¾æ˜¯çœŸçš„ï¼
        "GT_Ch2_Mismatch": 0, # CLIPåˆ†ä¸å‡º Noon å’Œ Night çš„åŒºåˆ«ï¼Œè¿™é‡Œé€šå¸¸ä¼šæ¼è¿‡
        "GT_Ch3_Logic": 1, # <--- åªæœ‰è¿™é‡Œæ˜¯ 1
        # Meta å¡«å†™çœŸå®å±æ€§ (Day)ï¼Œè¿™æ ·ä»£ç æ‰èƒ½åˆ¤æ–­å‡º Text(Night) æ˜¯é”™çš„
        "Meta_Time": "Day", "Meta_Weather": "Sunny", "Meta_Location": "Street",
        "Meta_Fact": "Noon", "Meta_Object": "Street",
        "Source_Note": "ã€å‡ã€‘é€»è¾‘é™·é˜±ï¼ŒCh1/Ch2éƒ½å¤±æ•ˆï¼Œåªæœ‰Ch3èƒ½æ‹¦æˆª"
    }
]

# ============================================================================
# ç”Ÿæˆæ–‡ä»¶
# ============================================================================
df = pd.DataFrame(data)
df = df[columns_order]

file_name = "Yuanjing_Data_Standard_Final.xlsx"

try:
    df.to_excel(file_name, index=False)
    print(f"âœ… æˆåŠŸç”Ÿæˆæ¼”ç¤ºä¸“ç”¨æ•°æ®è¡¨: {file_name}")
    print("\nğŸ’¡ ç­”è¾©æ¼”ç¤ºé€»è¾‘æ£€æŸ¥:")
    print("1. Tamper_AIGC ç±» -> è¯æ˜ MVSS-Net çš„ä¸å¯æ›¿ä»£æ€§ (èƒ½æŠ“ P å›¾)")
    print("2. Mismatch ç±» -> è¯æ˜ CLIP çš„åŸºç¡€è¿‡æ»¤èƒ½åŠ› (èƒ½æŠ“ä¹±é…æ–‡)")
    print("3. Logic_Trap ç±» -> è¯æ˜ æ¨ç†å¼•æ“ çš„é«˜çº§è®¤çŸ¥èƒ½åŠ› (èƒ½æŠ“ç»†èŠ‚æ’’è°)")
    print("\nè¯·ç¡®ä¿å›¢é˜Ÿä¸¥æ ¼æŒ‰ç…§æ­¤é€»è¾‘å½•å…¥åç»­æ•°æ®ï¼")
except ImportError:
    print("âŒ éœ€è¦å®‰è£… openpyxl")
except Exception as e:
    print(f"âŒ é”™è¯¯: {e}")